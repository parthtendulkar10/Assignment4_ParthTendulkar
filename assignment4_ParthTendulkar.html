<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Parth Tendulkar">

<title>Does Age Matter in Hollywood Casting? What the Numbers Say</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="assignment4_ParthTendulkar_files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment4_ParthTendulkar_files/libs/quarto-html/quarto.js"></script>
<script src="assignment4_ParthTendulkar_files/libs/quarto-html/popper.min.js"></script>
<script src="assignment4_ParthTendulkar_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment4_ParthTendulkar_files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment4_ParthTendulkar_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment4_ParthTendulkar_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment4_ParthTendulkar_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment4_ParthTendulkar_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment4_ParthTendulkar_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="tabs.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Does Age Matter in Hollywood Casting? What the Numbers Say</h1>
<p class="subtitle lead">Assignment 4 ETC5512</p>
</div>



<div class="quarto-title-meta column-page">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Parth Tendulkar </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="tab-buttons">
<div>
<p><button class="tab-button active" id="tab1" onclick="activateTab('tab1')">üìä Data</button> <button class="tab-button" id="tab2" onclick="activateTab('tab2')">üìù Blog</button> <button class="tab-button" id="tab3" onclick="activateTab('tab3')">üé¨ Behind the Scenes</button></p>
</div>
</div>
<div id="tab-content" class="tab-content tab1-bg">
<div id="panel-tab1" class="tab-panel active">
<section id="data-and-documenting" class="level2">
<h2 class="anchored" data-anchor-id="data-and-documenting">Data and Documenting</h2>
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question">Research Question</h3>
<p><big> <strong>Does the age and gender dynamics of lead actors influence the commercial success of movies?</strong></big></p>
<p>Hollywood has historically exhibited a noticeable pattern in casting, with older male actors frequently paired with significantly younger female counterparts‚Äîan occurrence far less common in reverse. This project aims to investigate whether such casting decisions are financially beneficial or simply reflective of longstanding industry biases. By combining a dataset containing actor ages and gender with another comprising detailed movie profit information, this analysis seeks to determine whether these casting patterns correlate with financial performance or persist without economic justification.</p>
</section>
<section id="data-being-used" class="level3">
<h3 class="anchored" data-anchor-id="data-being-used">Data Being used</h3>
<p><strong>This analysis utilizes two publicly available datasets:</strong></p>
<ul>
<li><a href="https://github.com/ntdoris/movie-revenue-analysis/blob/main/README.md"><strong>Movie Revenue Dataset</strong></a>: This dataset includes information such as production budget, domestic and international gross earnings, total profit, return on investment (ROI), and genre classifications.</li>
<li><a href="https://hollywoodagegap.com"><strong>Hollywood Age Gap Dataset</strong></a>: This dataset includes actor names, their ages at the time of each film‚Äôs release, character genders, and the age gaps between romantic leads.</li>
</ul>
<p><strong>These datasets are well-suited for the objectives of this study for the following reasons:</strong></p>
<ul>
<li>Together, these datasets provide comprehensive coverage of both financial performance and casting demographics.</li>
<li>Key variables required for analysis (age, profit, ROI, gender) are readily available and well-structured.</li>
<li>Data is in a clean and accessible format, facilitating efficient processing and exploration.</li>
<li>The age gap dataset does not have a formal license but permits use with attribution, which will be appropriately cited.</li>
<li>Both datasets are suitable sample sources for the analytical scope expected at this academic level.</li>
</ul>
</section>
<section id="downloading-data" class="level3">
<h3 class="anchored" data-anchor-id="downloading-data">Downloading Data</h3>
<p><strong>Steps to Download <em>Hollywood Age Gap</em> Dataset Data</strong></p>
<ul>
<li>Navigate to the official website: <a href="https://hollywoodagegap.com"><strong>www.hollywoodagegap.com</strong></a><br>
</li>
<li>Click on the <strong>‚ÄúDownload Data‚Äù</strong> button located in the <strong>Top Right Corner</strong> of the homepage.</li>
<li>Save the downloaded <strong>CSV file</strong> into the <code>data</code> folder within the project directory to ensure proper access during analysis.</li>
</ul>
<p><strong>Steps to Download <em>Movie Revenue Dataset</em> Dataset Data</strong></p>
<ul>
<li>Go to the <strong>movie-revenue-analysis</strong> Github Repository:<br>
visit <a href="https://github.com/ntdoris/movie-revenue-analysis" class="uri">https://github.com/ntdoris/movie-revenue-analysis</a></li>
<li>Locate the dataset:<br>
In the repo, go to the <code>data</code> folder. and locate <code>final_dataset.csv</code>.</li>
<li>Download the file:
<ul>
<li>Click on the dataset file.</li>
<li>Click the <strong>‚ÄúDownload raw file‚Äù</strong> button.<br>
</li>
</ul></li>
<li>Save the downloaded <strong>CSV file</strong> into the <code>data</code> folder within the project directory to ensure proper access during analysis.</li>
</ul>
</section>
<section id="data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-analysis">Data Analysis</h3>
<ol type="1">
<li><strong>Load Libraries</strong></li>
</ol>
<p>Loading all the essential libraries for data exploration and analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li><strong>Read in the Data</strong></li>
</ol>
<p>Read in the downloaded CSV‚Äôs in dataframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>age_gaps_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/movies.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>revenue_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/final_dataset.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><strong>Cleaning Data</strong></li>
</ol>
<p>Convert movie names in both datasets to lowercase (or any consistent format) to make sure they match properly during the join. Titles might look the same visually but mismatch due to case differences, extra spaces, or punctuation, so this helps avoid losing valid matches.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>age_gaps_clean <span class="ot">&lt;-</span> age_gaps_raw <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">join_title =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(<span class="st">`</span><span class="at">Movie Name</span><span class="st">`</span>)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>revenue_clean <span class="ot">&lt;-</span> revenue_raw <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">join_title =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(movie)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li><strong>join datasets</strong></li>
</ol>
<p>Join datasets using Movie names and release year and drop all the non matches so that we can use this data for accurate analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> age_gaps_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(revenue_clean, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"join_title"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Release Year"</span> <span class="ot">=</span> <span class="st">"year"</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filtering out non matches</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(production_budget))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li><strong>create new variables</strong></li>
</ol>
<p>Creating new variables:</p>
<ul>
<li><code>Older Actor</code> : Out of the pair what gender actor is older.<br>
</li>
<li><code>Avg Actor Age</code> : Mean of <code>Actor 1 Age</code> and <code>Actor 2 Age</code>.<br>
</li>
<li><code>Profit (Millions)</code> : Profit the movie made in Millions for easier understanding.</li>
<li><code>Age Group</code> : Actor age binned into groups.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Actor 1 Age</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="st">`</span><span class="at">Actor 2 Age</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Actor 1 Gender</span><span class="st">`</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Actor 1 Age</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="st">`</span><span class="at">Actor 2 Age</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Actor 2 Gender</span><span class="st">`</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Same age"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Avg Actor Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="st">`</span><span class="at">Actor 1 Age</span><span class="st">`</span>, <span class="st">`</span><span class="at">Actor 2 Age</span><span class="st">`</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Profit (Millions)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(profit <span class="sc">/</span> <span class="dv">1000000</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Age Group</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">cut</span>(<span class="st">`</span><span class="at">Avg Actor Age</span><span class="st">`</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">100</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"15‚Äì30"</span>, <span class="st">"31‚Äì40"</span>, <span class="st">"41‚Äì50"</span>, <span class="st">"51‚Äì60"</span>, <span class="st">"60+"</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">right =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li><strong>Plot 1: Average Actor Age vs Profit</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Profit (Millions)</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Profit Distribution by Actor Age Group"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Average Actor Age Group"</span>, <span class="at">y =</span> <span class="st">"Profit (Millions USD)"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li><strong>Plot 2: Age Difference vs Profit and ROI</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Profit vs Age Difference</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Age Difference</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Profit (Millions)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#6a0dad"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Profit vs Age Gap"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Gap (Years)"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Profit (Millions USD)"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ROI vs Age Difference</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Age Difference</span><span class="st">`</span>, <span class="at">y =</span> roi)) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#ff5733"</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ROI vs Age Gap"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Gap (Years)"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Return on Investment (ROI)"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine side by side</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>age_diff <span class="ot">&lt;-</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="8" type="1">
<li><strong>Plot 2: Older Actor Gender vs Profit and ROI</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Profit (Millions)</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Profit by Older Actor Gender"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Profit (Millions USD)"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ROI by Older Actor</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span>, <span class="at">y =</span> roi, <span class="at">fill =</span> <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ROI by Older Actor Gender"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Return on Investment (ROI)"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>older_actor_plot <span class="ot">&lt;-</span> p4 <span class="sc">+</span> p5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="9" type="1">
<li>Dropping irrelevant variables and exporting CSV.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Movie Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Release Year</span><span class="st">`</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actor 1 Age</span><span class="st">`</span>, <span class="st">`</span><span class="at">Actor 2 Age</span><span class="st">`</span>, <span class="st">`</span><span class="at">Actor 1 Gender</span><span class="st">`</span>, <span class="st">`</span><span class="at">Actor 2 Gender</span><span class="st">`</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Age Difference</span><span class="st">`</span>, <span class="st">`</span><span class="at">Older Actor</span><span class="st">`</span>, <span class="st">`</span><span class="at">Avg Actor Age</span><span class="st">`</span>, <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    production_budget, profit, <span class="st">`</span><span class="at">Profit (Millions)</span><span class="st">`</span>, roi</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(joined_data,<span class="fu">here</span>(<span class="st">"data/processed_movie_gender_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="addtional-information" class="level3">
<h3 class="anchored" data-anchor-id="addtional-information">Addtional Information</h3>
<p>For version tracking and transparency, I have maintained a public GitHub repository containing all development stages of the project.</p>
<p>In addition to that I have added the following files for the markers to review:</p>
<ul>
<li><p><code>README.md</code>: Provides a summary of the project, methodology, and ethical considerations behind the analysis.</p></li>
<li><p><code>data_dictionary.csv</code>: Contains clear definitions and descriptions of all key variables used after joining and cleaning the datasets.</p></li>
<li><p><code>tabs.css</code>: Custom CSS file used to implement the tabbed layout and theming in the final visual narrative.</p></li>
</ul>
</section>
<section id="ai-acknowlegement" class="level3">
<h3 class="anchored" data-anchor-id="ai-acknowlegement">AI Acknowlegement</h3>
<p>Parts of the exploratory writing, code editing, and blog-style formatting in this project were supported by OpenAI‚Äôs ChatGPT. The tool was used to help refine language, summarize insights, and structure reflections during the analysis process. All decisions related to data handling, interpretation, and final presentation were made by the student.</p>
<p><a href="https://chatgpt.com/share/68528c6d-79f4-800d-a46c-e462a11f2174">ChatGPT Queries</a></p>
</section>
</section>
</div>
<div id="panel-tab2" class="tab-panel">
<section id="blog-post" class="level2">
<h2 class="anchored" data-anchor-id="blog-post">Blog post</h2>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">Motivation</h3>
<p>One thing you see all the time in movies is older male leads being cast opposite much younger female love interests. It‚Äôs been the norm in Hollywood for decades ‚Äî so much so that most people barely question it anymore.</p>
<p>But I started wondering: does this actually make financial sense? Are these casting choices boosting a film‚Äôs profits, or are they just outdated habits that the industry keeps repeating?</p>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>To explore the link between casting age gaps and movie profitability, I used two main datasets.</p>
<p>The first came from <a href="hollywoodagegap.com">hollywoodagegap.com</a>, which includes details on romantic leads ‚Äî how old each actor was at the time of the movie, who was older, and the size of the age gap.</p>
<p>The second dataset, sourced from <a href="https://github.com/ntdoris/movie-revenue-analysis">GitHub Repository</a>, with info like production budget, domestic and international gross, total profit, and ROI.</p>
<p>I cleaned both datasets and matched them using the movie title and release year. To keep things accurate, I only used rows that matched correctly. I also added a new column to identify whether the older actor in the romantic pair was the man, the woman, or if they were the same age. Finally, I calculated the average age of the pair and grouped it into bins like 15‚Äì30, 31‚Äì40, and so on ‚Äî this helped make the analysis more structured and insightful.</p>
</section>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<section id="do-younger-romantic-leads-lead-to-higher-profits" class="level4">
<h4 class="anchored" data-anchor-id="do-younger-romantic-leads-lead-to-higher-profits"><big><strong>Do younger romantic leads lead to higher profits?</strong></big></h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_ParthTendulkar_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first plot examined how the average age of romantic leads relates to profit, using age bins like 15‚Äì30, 31‚Äì40, etc., shown through a violin plot. The 15‚Äì30 group had the widest profit range with some standout outliers, suggesting a few highly profitable films. As the age group increased, profits declined and became more tightly packed. The 60+ group was the most stable in terms of profit variation but had the lowest overall returns.</p>
<p>This suggests that films with younger romantic leads tend to be more profitable ‚Äî possibly because they receive more marketing, target broader audiences, or belong to more commercial genres.</p>
</section>
<section id="what-happens-when-the-age-gap-between-leads-gets-larger" class="level4">
<h4 class="anchored" data-anchor-id="what-happens-when-the-age-gap-between-leads-gets-larger"><big><strong>What happens when the age gap between leads gets larger?</strong></big></h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_ParthTendulkar_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These next two plots looked at how the age gap between romantic leads affects profit and ROI. In both cases, there was a clear downward trend ‚Äî the larger the age gap, the lower the financial return.</p>
<p>Most of the top-performing films had an age gap under 10 years, while movies with bigger gaps generally saw lower profits and ROI. There were a few exceptions, but they were rare.</p>
<p>This points to a possible disconnect: casting couples with large age differences may not resonate as well with audiences ‚Äî and it might not pay off at the box office either.</p>
</section>
<section id="does-it-matter-whether-the-man-or-woman-is-older" class="level4">
<h4 class="anchored" data-anchor-id="does-it-matter-whether-the-man-or-woman-is-older"><big><strong>Does it matter whether the man or woman is older?</strong></big></h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_ParthTendulkar_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These final set of plots compared profit and ROI based on which actor was older ‚Äî the man, the woman, or if they were the same age.</p>
<p>Profit levels were fairly consistent across all groups. But when it came to ROI, same-age pairings performed the best. Interestingly, movies with older female leads did just as well ‚Äî if not slightly better ‚Äî than those with older male leads.</p>
<p>This challenges the old stereotype that older women can‚Äôt drive box office success. The data suggests they absolutely can.</p>
</section>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Overall, this analysis suggests that some of Hollywood‚Äôs go-to casting choices aren‚Äôt really backed by the numbers.</p>
<p>Younger romantic leads tend to bring in more profit, while larger age gaps between leads often lead to lower returns. Surprisingly, same-age pairings came out on top for ROI ‚Äî and there‚Äôs no clear advantage to casting older men with younger women.</p>
<p>If anything, the data points toward more balanced casting being a smarter move ‚Äî both creatively and financially. Maybe it‚Äôs time for studios to rethink some of those old habits.</p>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<ul>
<li><p><strong>Hollywood Age Gap Dataset</strong> Fisher, L. (n.d.). Hollywood Age Gap. Retrieved June 2025, from https://hollywoodagegap.com</p></li>
<li><p><strong>Movie Revenue Dataset</strong> Doris, N. (2023). Movie Revenue Analysis. GitHub repository. https://github.com/ntdoris/movie-revenue-analysis</p></li>
<li><p><strong>R Programming Language</strong> R Core Team. (2023). R: A language and environment for statistical computing (Version 4.3.1) [Computer software]. R Foundation for Statistical Computing. https://www.R-project.org/</p></li>
<li><p><strong>Tidyverse Package</strong> Wickham H, Averick M, Bryan J, Chang W, McGowan LD, Fran√ßois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, M√ºller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). ‚ÄúWelcome to the tidyverse.‚Äù <em>Journal of Open Source Software</em>, <em>4</em>(43), 1686. doi:10.21105/joss.01686 <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.</p></li>
<li><p><strong>readR Package</strong> Wickham H, Hester J, Bryan J (2024). <em>readr: Read Rectangular Text Data</em>. R package version 2.1.5, <a href="https://CRAN.R-project.org/package=readr" class="uri">https://CRAN.R-project.org/package=readr</a>.</p></li>
<li><p><strong>here package</strong> M√ºller K (2020). <em>here: A Simpler Way to Find Your Files</em>. R package version 1.0.1, <a href="https://CRAN.R-project.org/package=here" class="uri">https://CRAN.R-project.org/package=here</a>.</p></li>
<li><p><strong>scales package</strong> Wickham H, Pedersen T, Seidel D (2023). <em>scales: Scale Functions for Visualization</em>. R package version 1.3.0, <a href="https://CRAN.R-project.org/package=scales" class="uri">https://CRAN.R-project.org/package=scales</a>.</p></li>
<li><p><strong>patchwork package</strong> Pedersen T (2024). <em>patchwork: The Composer of Plots</em>. R package version 1.3.0, <a href="https://CRAN.R-project.org/package=patchwork" class="uri">https://CRAN.R-project.org/package=patchwork</a>.</p></li>
</ul>
</section>
</section>
</div>
<div id="panel-tab3" class="tab-panel">
<section id="behind-the-scenes" class="level2">
<h2 class="anchored" data-anchor-id="behind-the-scenes">Behind the Scenes</h2>
<section id="unseen-work" class="level3">
<h3 class="anchored" data-anchor-id="unseen-work">Unseen Work</h3>
<p>There was definitely a lot of behind-the-scenes wrangling that didn‚Äôt make it to the blog. Matching the two datasets by movie title and release year was super tedious ‚Äî some titles were formatted differently or had weird characters, so I had to manually clean a bunch. Also, just checking if age differences and gender columns made sense after merging took time. Creating the ‚Äúwho‚Äôs older‚Äù column seemed simple but ended up needing a few logic tweaks to get right. Most of the time went into cleaning stuff that should‚Äôve just worked.</p>
</section>
<section id="challenges-faced" class="level3">
<h3 class="anchored" data-anchor-id="challenges-faced">Challenges Faced</h3>
<p>Biggest challenge was merging the two datasets properly. I assumed it would be a straight match on movie title + year, but even small title changes (like extra spaces or colons) threw things off. I also didn‚Äôt expect profit to have such massive values that it had to be displayed in millions. Another challenge was figuring out how to represent profit when values were both negative and positive ‚Äî some plots didn‚Äôt handle that well.</p>
</section>
<section id="future-improvements" class="level3">
<h3 class="anchored" data-anchor-id="future-improvements">Future Improvements</h3>
<p>One major limitation is that this only looks at a subset of movies ‚Äî the ones that exist in both datasets. So the sample size could be biased. Also, I didn‚Äôt factor in genres or budget scale, which might affect profit trends. Ideally, I‚Äôd add genre grouping or control for budget levels next time. Another thing: I didn‚Äôt include any qualitative stuff like reviews or audience scores, which could show why certain age gaps don‚Äôt work.</p>
</section>
<section id="iteration-process-5-versions" class="level3">
<h3 class="anchored" data-anchor-id="iteration-process-5-versions">Iteration Process (5 versions)</h3>
<p><strong>All Version of this Project are present in this <a href="https://github.com/parthtendulkar10/Assignment4_ParthTendulkar">GitHub Repository</a></strong></p>
<ul>
<li><p>Version 1 (4d61aa2169d856722a994f09c01748034aab4089):<br>
In this first version, I loaded both datasets and previewed the structure. I attempted to join them by movie title only, but this led to poor match rates. The goal here was to understand the variables and check if there was potential for deeper analysis.</p></li>
<li><p>Version 2 (d3c5e1f86fcc273e7e78d06f4e8ea4adde2b478c):<br>
This version addressed the matching issue by trimming and lowercasing movie titles and joining them using both name and year. This improved the dataset integrity. Non-matching rows were dropped so only valid pairs remained. This version established a clean base for reliable analysis.</p></li>
<li><p>Version 3 (2eb456c9781e68cacb85aa83b13adf7f00bd7446):<br>
In this stage, I created new columns including Avg Actor Age, Older Actor, and Profit (Millions). I also binned average actor age into ranges for plotting. This version introduced the first meaningful visualisations showing relationships between age variables and financial outcomes.</p></li>
<li><p>Version 4 (879e29f8351d3147b35137134670427599971e40):<br>
Wrote and added the first full draft of the blog post, structured around motivation, data, analysis, and conclusions. Each visualisation was embedded with its explanation. This version focused purely on narrative clarity and alignment with the rubric.</p></li>
<li><p>Version 5 (372641812c62448088e4f7dfe3cc8723c6f97e38):<br>
This is the final submitted version after adding behind the scenes section, data dictionary, readme, and CSS and JS to style the report and blog to give it a personal touch. The writting was also refined and AI acknowledgement was also added.</p></li>
</ul>
</section>
</section>
</div>
</div>
<script>
function activateTab(tabId) {
  const buttons = document.querySelectorAll('.tab-button');
  const panels = document.querySelectorAll('.tab-panel');
  const container = document.getElementById('tab-content');

  buttons.forEach(btn => btn.classList.remove('active'));
  panels.forEach(p => p.classList.remove('active'));
  container.classList.remove('tab1-bg', 'tab2-bg', 'tab3-bg');

  document.getElementById(tabId).classList.add('active');
  document.getElementById('panel-' + tabId).classList.add('active');
  container.classList.add(tabId + '-bg');
}
</script>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>